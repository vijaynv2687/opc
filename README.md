This repo would help you to create a compartment, vcn, subnet and an instance(in the same compartment created) with single terraform apply. 
For ease of understanding, i have also uploaded the terraform graph of this code.
